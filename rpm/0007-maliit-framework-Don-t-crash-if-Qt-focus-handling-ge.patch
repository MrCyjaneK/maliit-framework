From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Pekka Vuorela <pekka.vuorela@jollamobile.com>
Date: Fri, 28 Oct 2016 14:20:34 +0300
Subject: [PATCH] [maliit-framework] Don't crash if Qt focus handling gets into
 bad state. Contributes to JB#36706

---
 input-context/minputcontext.cpp | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/input-context/minputcontext.cpp b/input-context/minputcontext.cpp
index 118e027..fed9d1f 100644
--- a/input-context/minputcontext.cpp
+++ b/input-context/minputcontext.cpp
@@ -826,6 +826,11 @@ void MInputContext::updateInputMethodExtensions()
     }
     if (debug) qDebug() << InputContextName << __PRETTY_FUNCTION__;
 
+    if (!qGuiApp->focusObject()) {
+        qWarning() << "Qt focus handling broken!";
+        return;
+    }
+
     QVariantMap extensions = qGuiApp->focusObject()->property("__inputMethodExtensions").toMap();
     QVariant value;
     value = extensions.value("enterKeyIconSource");
-- 
2.35.1

